<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" 
                   assembly="Commencement.Core" namespace="Commencement.Core.Domain">
  <class
    name="Ceremony"
    table="Ceremonies">
    <id name="Id" column="ID" unsaved-value="0">
      <generator class="identity" />
    </id>

    <property name="Location" column="Location" />
    <property name="DateTime" column="DateTime" />
    <property name="TicketsPerStudent" column="TicketsPerStudent" />
    <property name="TotalTickets" column="TotalTickets" />
    <property name="PrintingDeadline" column="PrintingDeadline" />
    <property name="RegistrationDeadline" column="RegistrationDeadline" />
    <property name="ExtraTicketDeadline" column="ExtraTicketDeadline" />
    <property name="ExtraTicketPerStudent" column="ExtraTicketPerStudent" />
    
    <many-to-one name="TermCode" class="TermCode" column="TermCode" ></many-to-one>
    
    <bag name="Registrations" cascade="all-delete-orphan">
      <key column="CeremonyId"></key>
      <one-to-many class="Registration"/>
    </bag>

    <bag name="Majors" table="CeremonyMajors" cascade="save-update">
      <key column="CeremonyId"></key>
      <many-to-many column="MajorCode" class="MajorCode"></many-to-many>
    </bag>

    <bag name="RegistrationPetitions" table="RegistrationPetitions" cascade="none">
      <key column="CeremonyId"></key>
      <one-to-many class="RegistrationPetition"/>
    </bag>

    <bag name="Editors" table="CeremonyEditors" cascade="all-delete-orphan" inverse="true">
      <key column="CeremonyId"></key>
      <one-to-many class="CeremonyEditor"></one-to-many>
    </bag>
    
  </class>
</hibernate-mapping>